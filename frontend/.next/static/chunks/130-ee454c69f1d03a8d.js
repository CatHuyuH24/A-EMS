"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[130],{9159:function(e,t,r){r.d(t,{aj:function(){return v},gE:function(){return d},hB:function(){return g},f0:function(){return u},aU:function(){return c},su:function(){return f},$3:function(){return h}});var n=r(1770),a=r(9827),s=r(1323),o=r(7764),i=r(9064);let u=()=>(0,n.D)({mutationFn:async e=>o.tN.getState().login(e.email,e.password),onSuccess:()=>{i.ZP.success("Login successful!")},onError:e=>{var t,r;i.ZP.error((null==e?void 0:null===(r=e.response)||void 0===r?void 0:null===(t=r.data)||void 0===t?void 0:t.detail)||"Login failed")}}),c=()=>{let e=(0,a.NL)();return(0,n.D)({mutationFn:async()=>o.tN.getState().logout(),onSuccess:()=>{e.clear(),i.ZP.success("Logged out successfully")},onError:t=>{var r,n;e.clear(),i.ZP.error((null==t?void 0:null===(n=t.response)||void 0===n?void 0:null===(r=n.data)||void 0===r?void 0:r.detail)||"Logout failed")}})};var l=r(6593);let h=()=>{let e=(0,a.NL)();return(0,n.D)({mutationFn:async e=>(await s.h.post("/chat/messages",e)).data,onSuccess:(t,r)=>{e.setQueryData(["chat","messages",r.conversationId],e=>e?[...e,t]:[t]),e.invalidateQueries({queryKey:["chat","conversations"]})},onError:e=>{var t,r;i.ZP.error((null==e?void 0:null===(r=e.response)||void 0===r?void 0:null===(t=r.data)||void 0===t?void 0:t.detail)||"Failed to send message")}})},d=()=>(0,l.a)({queryKey:["chat","suggestions"],queryFn:async()=>(await s.h.get("/chat/suggestions")).data,staleTime:3e5}),g=()=>(0,l.a)({queryKey:["dashboard","metrics"],queryFn:async()=>(await s.h.get("/dashboard/metrics")).data,staleTime:6e4,refetchInterval:3e5}),f=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:10;return(0,l.a)({queryKey:["dashboard","activities",e],queryFn:async()=>(await s.h.get("/dashboard/activities",{params:{limit:e}})).data,staleTime:3e4,refetchInterval:6e4})},v=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:5;return(0,l.a)({queryKey:["dashboard","ai-insights",e],queryFn:async()=>(await s.h.get("/dashboard/ai-insights",{params:{limit:e}})).data,staleTime:12e4,refetchInterval:6e5})}},1323:function(e,t,r){r.d(t,{h:function(){return i}});var n=r(3464),a=r(9064),s=r(257);class o{setupInterceptors(){this.client.interceptors.request.use(e=>(this.authToken&&(e.headers.Authorization="Bearer ".concat(this.authToken)),e.headers["X-Correlation-ID"]=this.generateCorrelationId(),e),e=>Promise.reject(e)),this.client.interceptors.response.use(e=>e,async e=>{var t;let r=e.config;if((null===(t=e.response)||void 0===t?void 0:t.status)===401&&!r._retry){r._retry=!0;try{return await this.handleTokenRefresh(),this.client(r)}catch(e){return this.handleAuthError(),Promise.reject(e)}}return this.handleApiError(e),Promise.reject(e)})}generateCorrelationId(){return"frontend-".concat(Date.now(),"-").concat(Math.random().toString(36).substr(2,9))}async handleTokenRefresh(){let e=localStorage.getItem("refreshToken");if(!e)throw Error("No refresh token available");let t=await this.client.post("/auth/refresh",{refreshToken:e}),{accessToken:r}=t.data;return this.setAuthToken(r),t.data}handleAuthError(){this.removeAuthToken(),localStorage.removeItem("refreshToken"),window.location.pathname.startsWith("/login")||(window.location.href="/login")}handleApiError(e){var t,r;let n=(null===(t=e.response)||void 0===t?void 0:t.data)||{error:"Network Error",message:"Unable to connect to the server"};switch(null===(r=e.response)||void 0===r?void 0:r.status){case 400:a.Am.error(n.message||"Invalid request");break;case 401:break;case 403:a.Am.error("Access denied. You don't have permission to perform this action.");break;case 404:a.Am.error("The requested resource was not found.");break;case 422:a.Am.error(n.message||"Validation failed");break;case 429:a.Am.error("Too many requests. Please try again later.");break;case 500:case 502:case 503:case 504:a.Am.error("Server error. Please try again later.");break;default:navigator.onLine?a.Am.error(n.message||"An unexpected error occurred"):a.Am.error("No internet connection. Please check your network.")}}setAuthToken(e){this.authToken=e}removeAuthToken(){this.authToken=null}async get(e,t){return this.client.get(e,t)}async post(e,t,r){return this.client.post(e,t,r)}async put(e,t,r){return this.client.put(e,t,r)}async patch(e,t,r){return this.client.patch(e,t,r)}async delete(e,t){return this.client.delete(e,t)}constructor(){this.authToken=null,this.auth={login:e=>this.post("/auth/login",e),logout:()=>this.post("/auth/logout"),refreshToken:e=>this.post("/auth/refresh",{refreshToken:e}),getMe:()=>this.get("/auth/me"),changePassword:e=>this.put("/auth/password",e)},this.dashboard={getOverview:()=>this.get("/dashboard/overview"),getMetrics:e=>this.get("/dashboard/metrics",{params:{timeframe:e}})},this.chat={sendMessage:e=>this.post("/ai/chat",e),getChatHistory:e=>this.get("/ai/chat/history/".concat(e)),getSuggestions:()=>this.get("/ai/suggestions")},this.sales={getMetrics:()=>this.get("/sales/metrics"),getCustomers:e=>this.get("/sales/customers",{params:e}),getPipeline:()=>this.get("/sales/pipeline")},this.finance={getMetrics:()=>this.get("/finance/metrics"),getBudgets:()=>this.get("/finance/budgets"),getExpenses:e=>this.get("/finance/expenses",{params:e})},this.hr={getMetrics:()=>this.get("/hr/metrics"),getEmployees:e=>this.get("/hr/employees",{params:e})},this.reports={getReports:e=>this.get("/reports",{params:e}),generateReport:e=>this.post("/reports/generate",e),getReport:e=>this.get("/reports/".concat(e))},this.client=n.Z.create({baseURL:s.env.NEXT_PUBLIC_API_BASE_URL||"http://localhost:8000/api",timeout:3e4,headers:{"Content-Type":"application/json"}}),this.setupInterceptors()}}let i=new o},8685:function(e,t,r){r.d(t,{Z6:function(){return a}});var n=r(257);n.env.NEXT_PUBLIC_API_BASE_URL;let a={HOME:"/",LOGIN:"/login",DASHBOARD:"/dashboard",CHAT:"/chat",SALES:"/sales",FINANCE:"/finance",HR:"/hr",REPORTS:"/reports",PROFILE:"/profile",SETTINGS:"/settings"};n.env.NEXT_PUBLIC_API_BASE_URL,n.env.NEXT_PUBLIC_WEBSOCKET_URL,n.env.NEXT_PUBLIC_APP_VERSION},4508:function(e,t,r){r.d(t,{Jh:function(){return h},SY:function(){return i},cn:function(){return s},rl:function(){return l},uf:function(){return c},xG:function(){return u}});var n=r(1994),a=r(3335);function s(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];return(0,a.m6)((0,n.W)(t))}let o=(e,t)=>("string"==typeof e?new Date(e):e).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric",...t}),i=e=>{let t=new Date,r="string"==typeof e?new Date(e):e,n=Math.floor((t.getTime()-r.getTime())/1e3);if(n<60)return"Just now";if(n<3600){let e=Math.floor(n/60);return"".concat(e," minute").concat(e>1?"s":""," ago")}if(n<86400){let e=Math.floor(n/3600);return"".concat(e," hour").concat(e>1?"s":""," ago")}{if(!(n<2592e3))return o(r);let e=Math.floor(n/86400);return"".concat(e," day").concat(e>1?"s":""," ago")}},u=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"USD",r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"en-US";return new Intl.NumberFormat(r,{style:"currency",currency:t,minimumFractionDigits:2,maximumFractionDigits:2}).format(e)},c=(e,t)=>new Intl.NumberFormat("en-US",t).format(e),l=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;return"".concat((100*e).toFixed(t),"%")},h=e=>/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(e)},7764:function(e,t,r){r.d(t,{tN:function(){return o}}),r(7437);var n=r(9625),a=r(6885);r(2265);var s=r(1323);let o=(0,n.Ue)()((0,a.tJ)((e,t)=>({user:null,tokens:null,isAuthenticated:!1,isLoading:!1,error:null,login:async function(t,r){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];e({isLoading:!0,error:null});try{let{user:a,...o}=(await s.h.auth.login({email:t,password:r,rememberMe:n})).data;e({user:a,tokens:o,isAuthenticated:!0,isLoading:!1,error:null}),s.h.setAuthToken(o.accessToken)}catch(t){var a,o;throw e({user:null,tokens:null,isAuthenticated:!1,isLoading:!1,error:(null===(o=t.response)||void 0===o?void 0:null===(a=o.data)||void 0===a?void 0:a.message)||"Login failed"}),t}},logout:async()=>{e({isLoading:!0});try{await s.h.auth.logout()}catch(e){console.error("Logout API call failed:",e)}finally{e({user:null,tokens:null,isAuthenticated:!1,isLoading:!1,error:null}),s.h.removeAuthToken()}},refreshToken:async()=>{let{tokens:r}=t();if(!(null==r?void 0:r.refreshToken))throw Error("No refresh token available");try{let t=(await s.h.auth.refreshToken(r.refreshToken)).data;e({tokens:t,error:null}),s.h.setAuthToken(t.accessToken)}catch(e){throw t().logout(),e}},updateUser:r=>{let{user:n}=t();n&&e({user:{...n,...r}})},clearError:()=>{e({error:null})},setLoading:t=>{e({isLoading:t})}}),{name:"auth-storage",partialize:e=>({user:e.user,tokens:e.tokens,isAuthenticated:e.isAuthenticated})}))}}]);